@page "/students"
@using BlazorApp.Models
@using BlazorApp.Services
@using Newtonsoft.Json
@inject StudentService StudentService;
<h1>Student List</h1>


<div class="bg-white rounded mt-6 border border-bottom-0 position-relative ">

	<div class="d-flex justify-content-end gap-1 p-1 mt-4">
		<a class="btn btn-primary" href="/students/create" >Add Student</a>
		<button class="btn btn-primary">Save List</button>
	</div>

	<div class="d-flex justify-content-between mt-2 border p-1">
		<h6>Parent/Guardian List</h6>
		<div>
			<div class="input-group">
				<input type="search" name="search" placeholder="search" /><span class="bi bi-search input-group-text"></span>

			</div>

		</div>
	</div>

	<table class="table table-striped table-hover border p-1">
		<thead>
			<tr>
				<th class="text-primary">FirstName</th>
				<th class="text-primary">LastName</th>
				<th class="text-primary">Age</th>
				<th class="text-primary">Gender</th>
				<th>Action</th>
			</tr>
		</thead>
		<tbody>
			@foreach (var student in students)
			{
				<tr>
					<td>@student.FirstName</td>
					<td>@student.LastName</td>
					<td>@student.Age</td>
					<td>@student.Gender</td>
					<td><a class="bi bi-layout-text-sidebar-reverse text-primary" href="/students/details/@student.Id"></a> <a class="bi bi-pencil text-primary" href="/students/edit/@student.Id"></a> <a class="bi bi-trash text-primary" href="/students/delete/@student.Id"></a></td>
					@* <td>@student.FirstName</td> *@

				</tr>
			}
		</tbody>
	</table>
</div>

@code {

	private List<StudentModel> students = new List<StudentModel>();
	private Guid? parentId;
	private int page = 1;
	private int pageSize = 10;

	protected override async Task OnInitializedAsync()
	{
		var response = await StudentService.GetAllStudents(parentId, page, pageSize);
		students = JsonConvert.DeserializeObject<List<StudentModel>>(response.data.ToString());
	}

}
